{"version":3,"file":"workspace-creation-fn-D4FGyzy_.mjs","sources":["../../../../../../../../src/components/workspace-creation/workspace-creation-fn.ts?tsr-directive-use-server="],"sourcesContent":null,"names":["getWebsiteData_createServerFn_handler","createServerRpc","opts","signal","getWebsiteData.__executeServer","findWorkspaceUrl_createServerFn_handler","findWorkspaceUrl.__executeServer","resend","Resend","process","env","RESEND_API_KEY","addCollaborator_createServerFn_handler","addCollaborator.__executeServer","createWorkspace_createServerFn_handler","createWorkspace.__executeServer","getWebsiteData","createServerFn","method","validator","domain","handler","data","baseUrl","response","fetch","headers","redirect","AbortSignal","timeout","ok","Error","statusText","status","html","text","$","cheerio","load","title","attr","description","logoUrl","rawLogoUrl","startsWith","findWorkspaceUrl","url","workspaceUrl","workspace","db","query","findFirst","where","eq","addCollaborator","email","renderToString","CollaborationInvite","firstName","inviterName","projectName","token","error","emails","send","from","to","subject","message","createWorkspace","orgId","workspaceData","workspaceSchema","assert","id","nanoid","insertedWorkspace","insert","values","name","organizationId","logo","returning","success"],"mappings":"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"}